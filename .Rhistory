ggplot(mcp.by.period, aes(percent, value, color=period)) +
geom_point() +
theme_classic() +
theme(panel.grid=element_line(color='white')) +
labs(x='Percent of location points', y='Home range area (ha)', title='Skaiakos')
ggplot(mcp.by.period, aes(percent, value, color=period)) +
geom_point() +
geom_path() +
theme_classic() +
theme(panel.grid=element_line(color='white')) +
labs(x='Percent of location points', y='Home range area (ha)', title='Skaiakos')
# Then graph it.
ggplot(mcp.by.period, aes(percent, value, color=period)) +
geom_point() +
geom_path() +
theme_classic() +
theme(panel.grid=element_line(color='white')) +
labs(x='Percent of location points', y='Home range area (ha)', title='Skaiakos')
# Load in periods from previous notebook.
winter2 <- interval(ymd(20190101), ymd(20190414))
incubation <- interval(ymd(20190415), ymd(20190510))
nestling <- interval(ymd(20190511), ymd(20190710))
fledgling <- interval(ymd(20190711), ymd(20190901))
winter1 <- interval(ymd(20190902), ymd(20191231))
# Divide data into periods
sf.ska.per <- sf.ska %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
dplyr::select(geometry, period) %>%
as_Spatial()
# Calculate MCPs
mcp.by.period <- sf.ska.per %>%
mcp.area(percent=seq(20, 100, by=10),
unin='m', unout='ha', plotit=FALSE) %>%
rownames_to_column(var='name') %>%
mutate(percent=as.numeric(name)) %>%
dplyr::select(-name)
# Fix formatting so it can actually be graphed.
mcp.by.period <- pivot_longer(mcp.by.period,
cols=c('fledgling', 'nestling', 'winter'), names_to='period')
# Then graph it.
ggplot(mcp.by.period, aes(percent, value, color=period)) +
geom_point() +
geom_path() +
theme_classic() +
theme(panel.grid=element_line(color='white')) +
labs(x='Percent of location points', y='Home range area (ha)', title='Skaiakos')
install.packages("move")
library('move')
View(ska)
# Make a move object
ska$datetime <- ymd_hms(df$datetime, tz='America/Vancouver')
# Make a move object
ska$datetime <- ymd_hms(ska$datetime, tz='America/Vancouver')
move.ska <- move(x=ska$lon, y=ska$lat, time=ska$datetime)
move.ska <- move(x=ska$lon, y=ska$lat, time=ska$datetime, proj=CRS("+proj=longlat"))
View(sf.ska)
# Make a move object
sf.ska$datetime <- ymd_hms(sf.ska$datetime, tz='America/Vancouver')
move.ska <- move(x=ska$lon, y=ska$lat, time=ska$datetime, proj=CRS("+proj=longlat"))
hrBootstrap(x=move.ska, rep=25, unin='km', unout='km2')
hrBootstrap(x=move.ska, rep=25, unin='km', unout='km2', plot=FALSE)
sf.ska %>% as_Spatial() %>%
hrBootstrap(rep=25, unin='km', unout='km2', plot=FALSE)
hr <- hrBootstrap(x=move.ska, rep=25, unin='km', unout='km2', plot=FALSE)
View(hr)
ska$datetime <- ymd_hms(ska$datetime, tz='America/Vancouver')
move.ska <- move(x=ska$lon, y=ska$lat, time=ska$datetime, proj=CRS("+proj=longlat"))
hrBootstrap(x=move.ska, rep=25, unin='km', unout='km2', plot=TRUE)
hr <- hrBootstrap(x=move.ska, rep=25, unin='km', unout='km2', plot=TRUE)
View(hr)
View(move.ska)
View(sf.ska.per)
library('tidyverse')
library('sf')
library('rgdal')
library('adehabitatHR')
library('ggplot2')
library('ggspatial')
library('tibble')
library('lubridate')
library('move')
df <- read.csv('../data/processed/telem_all.csv', header=TRUE, stringsAsFactors=FALSE)
# Separate just the Skaiakos points to work with for now.
ska <- df %>%
filter(site == 'SKA') %>%
drop_na('lat')
# Make sf object.
sf.ska <- st_as_sf(ska, coords=c('lon', 'lat'))
sf.ska <- st_set_crs(sf.ska, '+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs')
# Transform to UTM so area makes sense.
sf.ska <- st_transform(sf.ska, "+proj=utm +zone=10 +datum=WGS84 +units=m +no_defs")
# Look at area.
mcp.ska <- sf.ska %>% as_Spatial() %>%
mcp.area(percent=seq(20, 100, by=10),
unin='m', unout='ha', plotit=FALSE) %>%
rownames_to_column(var='name') %>%
mutate(percent=as.numeric(name)) %>%
rename(area=a)
ggplot(mcp.ska, aes(percent, area)) +
geom_point() +
geom_path() +
theme_minimal() +
theme(panel.grid=element_line(color='white')) +
labs(x='Percent of location points', y='Home range area (ha)', title='Skaiakos')
# Load in periods from previous notebook.
winter2 <- interval(ymd(20190101), ymd(20190414))
incubation <- interval(ymd(20190415), ymd(20190510))
nestling <- interval(ymd(20190511), ymd(20190710))
fledgling <- interval(ymd(20190711), ymd(20190901))
winter1 <- interval(ymd(20190902), ymd(20191231))
# Divide data into periods
sf.ska.per <- sf.ska %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
dplyr::select(geometry, period) %>%
as_Spatial()
# Calculate MCPs
mcp.by.period <- sf.ska.per %>%
mcp.area(percent=seq(20, 100, by=10),
unin='m', unout='ha', plotit=FALSE) %>%
rownames_to_column(var='name') %>%
mutate(percent=as.numeric(name)) %>%
dplyr::select(-name)
# Fix formatting so it can actually be graphed.
mcp.by.period <- pivot_longer(mcp.by.period,
cols=c('fledgling', 'nestling', 'winter'), names_to='period')
# Then graph it.
ggplot(mcp.by.period, aes(percent, value, color=period)) +
geom_point() +
geom_path() +
theme_classic() +
theme(panel.grid=element_line(color='white')) +
labs(x='Percent of location points', y='Home range area (ha)', title='Skaiakos')
ska$datetime <- ymd_hms(ska$datetime, tz='America/Vancouver')
move.ska <- move(x=ska$lon, y=ska$lat, time=ska$datetime, proj=CRS("+proj=longlat"))
hrBootstrap(x=move.ska, rep=25, unin='km', unout='km2', plot=FALSE)
hr <- hrBootstrap(x=move.ska, rep=25, unin='km', unout='km2', plot=TRUE)
# Load in periods from previous notebook.
winter2 <- interval(ymd(20190101), ymd(20190414))
incubation <- interval(ymd(20190415), ymd(20190510))
nestling <- interval(ymd(20190511), ymd(20190710))
fledgling <- interval(ymd(20190711), ymd(20190901))
winter1 <- interval(ymd(20190902), ymd(20191231))
df <- read.csv('../data/processed/telem_all.csv', header=TRUE, stringsAsFactors=FALSE)
df %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
filter(period == 'nestling')
df %>%
drop_na('lat')
df %>%
drop_na('lat') %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
filter(period == 'nestling') %>%
select(id, lat, lon, datetime, sex, site)
df %>%
drop_na('lat') %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
filter(period == 'nestling') %>%
dplyr::select(id, lat, lon, datetime, sex, site)
df <- df %>%
drop_na('lat') %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
filter(period == 'nestling') %>%
dplyr::select(id, lat, lon, datetime, sex, site)
df <- df %>%
drop_na('lat') %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
filter(period == 'nestling') %>%
filter(id %in% c('HAR10', 'HAR09', 'HAR04', 'HAR05'))
View(df)
dplyr::select(id, lat, lon, datetime, sex, site, -yrls)
dplyr::select(id, lat, lon, datetime, sex, site)
df <- df %>%
drop_na('lat') %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
filter(period == 'nestling') %>%
filter(id %in% c('HAR10', 'HAR09', 'HAR04', 'HAR05')) %>%
dplyr::select(id, lat, lon, datetime, sex, site)
# Calculate MCPs
df %>%
as_Spatial()
View(df)
# Get subset of data we actually want.
df$datetime <- ymd_hms(df$datetime, tz='America/Vancouver')
df <- df %>%
drop_na('lat') %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
filter(period == 'nestling') %>%
filter(id %in% c('HAR10', 'HAR09', 'HAR04', 'HAR05')) %>%
dplyr::select(id, lat, lon, datetime, sex, site)
sf.df <- st_as_sf(df, coords=c('lon', 'lat')) %>%
st_set_crs('+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs')
sf.df <- st_as_sf(df, coords=c('lon', 'lat')) %>%
st_set_crs('+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs') %>%
st_transform("+proj=utm +zone=10 +datum=WGS84 +units=m +no_defs")
proj4string(sf.df)
class(sf.df)
crs(sf.df)
# Calculate MCPs
mcp <- sf.df %>%
mcp.area(percent=seq(20, 100, by=10),
unin='m', unout='ha', plotit=FALSE)
# Calculate MCPs
mcp <- sf.df %>% as_Spatial() %>%
mcp.area(percent=seq(20, 100, by=10),
unin='m', unout='ha', plotit=FALSE)
View(mcp)
View(sf.df)
df <- df %>%
drop_na('lat') %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
filter(period == 'nestling') %>%
filter(id %in% c('HAR10', 'HAR09', 'HAR04', 'HAR05')) %>%
dplyr::select(id, lat, lon)
sf.df <- st_as_sf(df, coords=c('lon', 'lat')) %>%
st_set_crs('+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs') %>%
st_transform("+proj=utm +zone=10 +datum=WGS84 +units=m +no_defs")
df <- df %>%
drop_na('lat') %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
filter(period == 'nestling') %>%
filter(id %in% c('HAR10', 'HAR09', 'HAR04', 'HAR05'))
df <- df %>%
drop_na('lat') %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
filter(period == 'nestling') %>%
filter(id %in% c('HAR10', 'HAR09', 'HAR04', 'HAR05'))
df <- read.csv('../data/processed/telem_all.csv', header=TRUE, stringsAsFactors=FALSE)
# Get subset of data we actually want.
df$datetime <- ymd_hms(df$datetime, tz='America/Vancouver')
df <- df %>%
drop_na('lat') %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
filter(period == 'nestling') %>%
filter(id %in% c('HAR10', 'HAR09', 'HAR04', 'HAR05'))
sf.df <- st_as_sf(df, coords=c('lon', 'lat')) %>%
st_set_crs('+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs') %>%
st_transform("+proj=utm +zone=10 +datum=WGS84 +units=m +no_defs")
# Calculate MCPs
mcp <- sf.df %>%
dplyr::select(id, geometry) %>%
as_Spatial() %>%
mcp.area(percent=seq(20, 100, by=10),
unin='m', unout='ha', plotit=FALSE)
View(mcp)
# Calculate MCPs
mcp <- sf.df %>%
dplyr::select(id, geometry) %>%
as_Spatial() %>%
mcp.area(percent=seq(20, 100, by=10),
unin='m', unout='ha', plotit=FALSE) %>%
rownames_to_column(var='name') %>%
mutate(percent=as.numeric(name)) %>%
dplyr::select(-name)
View(mcp)
colnames(mcp)
# Fix formatting so it can actually be graphed.
mcp <- pivot_longer(mcp,
cols=c('HAR04', 'HAR05', 'HAR09', 'HAR10'), names_to='id')
# Then graph it.
ggplot(mcp, aes(percent, value, color=id)) +
geom_point() +
geom_path() +
theme_classic() +
theme(panel.grid=element_line(color='white')) +
labs(x='Percentage location points', y='Home range area (ha)')
# Then graph it.
ggplot(mcp, aes(percent, value, color=id)) +
geom_point() +
geom_path() +
theme_classic() +
theme(panel.grid=element_line(color='white')) +
labs(x='Percentage location points', y='Home range area (ha)')
# Then graph it.
ggplot(mcp, aes(percent, value, color=id)) +
geom_point() +
geom_path() +
theme_classic() +
theme(panel.grid=element_line(color='white')) +
labs(x='Percentage location points', y='Home range area (ha)')
df <- read.csv('../data/processed/telem_all.csv', header=TRUE, stringsAsFactors=FALSE)
# Do the datetime thing.
df$datetime <- ymd_hms(df$datetime, tz='America/Vancouver')
# Select only the relevant data.
df <- df %>%
drop_na('lat') %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
filter(period == 'nestling') %>%
filter(id %in% c('HAR10', 'HAR09', 'HAR04', 'HAR05'))
# Do the spatial thing.
sf.df <- st_as_sf(df, coords=c('lon', 'lat')) %>%
st_set_crs('+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs') %>%
st_transform("+proj=utm +zone=10 +datum=WGS84 +units=m +no_defs")
# Calculate MCPs
mcp <- sf.df %>%
dplyr::select(id, geometry) %>%
as_Spatial() %>%
mcp.area(percent=seq(20, 100, by=10),
unin='m', unout='ha', plotit=FALSE) %>%
rownames_to_column(var='name') %>%
mutate(percent=as.numeric(name)) %>%
dplyr::select(-name)
# Fix formatting so it can actually be graphed.
mcp <- pivot_longer(mcp,
cols=c('HAR04', 'HAR05', 'HAR09', 'HAR10'), names_to='id')
# Then graph it.
ggplot(mcp, aes(percent, value, color=id)) +
geom_point() +
geom_path() +
theme_classic() +
theme(panel.grid=element_line(color='white')) +
labs(x='Percentage location points', y='Home range area (ha)')
# Calculate 90% MCPs
mcp.95 <- sf.df %>%
dplyr::select(id, geometry) %>%
as_Spatial() %>%
mcp.area(percent=90,
unin='m', unout='ha', plotit=FALSE) %>%
rownames_to_column(var='name') %>%
mutate(percent=as.numeric(name)) %>%
dplyr::select(-name)
# Calculate 90% MCPs
mcp.90 <- sf.df %>%
dplyr::select(id, geometry) %>%
as_Spatial() %>%
mcp.area(percent=90,
unin='m', unout='ha', plotit=FALSE) %>%
rownames_to_column(var='name') %>%
mutate(percent=as.numeric(name)) %>%
dplyr::select(-name)
# Fix formatting so it can actually be graphed.
mcp.90 <- pivot_longer(mcp.90,
cols=c('HAR04', 'HAR05', 'HAR09', 'HAR10'), names_to='id')
View(mcp.90)
# Calculate 90% MCPs
mcp.95 <- sf.df %>%
dplyr::select(id, geometry) %>%
as_Spatial() %>%
mcp.area(percent=95,
unin='m', unout='ha', plotit=FALSE)
View(mcp.95)
# Make a table
kable(mcp.95)
library('kable')
library('knitr')
# Make a table
kable(mcp.95)
# Make a table
kable(mcp.95, digits=2, row.names=NULL)
rownames(mcp.95)
# Make a table
kable(mcp.95, digits=2, row.names=NA)
# Make a table
kable(mcp.95, digits=2, row.names=FALSE)
# Make a table
kable(mcp.95, digits=2, row.names=FALSE, caption='95% MCPs for 2019 nestling season')
# Calculate 95% MCPs
mcp.95 <- sf.df %>%
dplyr::select(id, geometry) %>%
as_Spatial() %>%
mcp.area(percent=95,
unin='m', unout='ha', plotit=FALSE)
# Make a table
kable(mcp.95, digits=2, row.names=FALSE, caption='95% MCPs for 2019 nestling season')
# Calculate 95% MCPs
mcp.95 <- sf.df %>%
dplyr::select(id, geometry) %>%
as_Spatial() %>%
mcp.area(percent=95,
unin='m', unout='ha', plotit=FALSE)
# Make a table
kable(mcp.95, digits=2, row.names=FALSE, caption='95% MCPs for 2019 nestling season',
format='pandoc')
library('lubridate')
library('tidyverse')
library('sf')
library('adehabitatHR')
library('ggplot2')
library('knitr')
df <- read.csv('../data/processed/telem_all.csv', header=TRUE, stringsAsFactors=FALSE)
View(mcp.95)
mcp.95 %>% `rownames<-`('MCPs (ha)')
x <- 25
# Calculate 95% MCPs
mcp.95 <- sf.df %>%
dplyr::select(id, geometry) %>%
as_Spatial() %>%
mcp.area(percent=95,
unin='m', unout='ha', plotit=FALSE) %>%
`rownames<-`('95% MCPs (ha)')
# Make a table
kable(mcp.95, digits=2, title='2019 nestling season')
# Calculate 95% MCPs
mcp.95 <- sf.df %>%
dplyr::select(id, geometry) %>%
as_Spatial() %>%
mcp.area(percent=95,
unin='m', unout='ha', plotit=FALSE) %>%
`rownames<-`('95% MCPs (ha)')
# Make a table
kable(mcp.95, digits=2, title='2019 nestling season')
