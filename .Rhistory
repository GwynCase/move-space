20190902, 20200414)
dates <- c(20190415, 20190510, 20190511, 20190710, 20190711, 20190901,
20190902, 20200414) %>%
ymd() %>%
yday()
dates <- c(20190415, 20190510, 20190511, 20190710, 20190711, 20190901,
20190902, 20200414) %>%
ymd() %>%
yday() %>%
as.data.frame()
View(dates)
dates <- c(20190415, 20190510, 20190511, 20190710, 20190711, 20190901,
20190902, 20200414) %>%
ymd() %>%
yday() %>%
as.data.frame() %>%
mutate(name=c('s.inc', 'e.inc', 's.nst', 'e.nst', 's.flg', 'e.flg', 's.wnt', 'e.wnt'))
nestling <- interval(date$s.nst, dates$e.nst)
nestling <-
interval(date$s.nst, dates$e.nst)
interval(date$s.nst, dates$e.nst)
interval(date$s.nst, date$e.nst)
interval(dates$s.nst, dates$e.nst)
dates$s.nst
dates
dates[1,3]
dates[2,3]
dates[2, ]
dates[3, ]
dates[ ,s.nst]
dates[s.nst, ]
dates[3, ]
dates[ , 2]
dates <- tibble(x=c('s.inc', 'e.inc', 's.nst', 'e.nst', 's.flg', 'e.flg',
's.wnt', 'e.wnt'),
y=c(20190415, 20190510, 20190511, 20190710, 20190711, 20190901,
20190902, 20200414))
dates
dates <- tibble(doy=c('s.inc', 'e.inc', 's.nst', 'e.nst', 's.flg', 'e.flg',
's.wnt', 'e.wnt'),
per=c(20190415, 20190510, 20190511, 20190710, 20190711, 20190901,
20190902, 20200414))
dates
dates$per[2]
dates$per[e.inc]
dates <- tibble(doy=c('s.inc', 'e.inc', 's.nst', 'e.nst', 's.flg', 'e.flg',
's.wnt', 'e.wnt'),
per=c(20190415, 20190510, 20190511, 20190710, 20190711, 20190901,
20190902, 20200414)) %>%
ymd() %>%
yday()
dates <- tibble(doy=c('s.inc', 'e.inc', 's.nst', 'e.nst', 's.flg', 'e.flg',
's.wnt', 'e.wnt'),
per=c(20190415, 20190510, 20190511, 20190710, 20190711, 20190901,
20190902, 20200414)) %>%
ymd(doy) %>%
yday(doy)
dates <- tibble(doy=c('s.inc', 'e.inc', 's.nst', 'e.nst', 's.flg', 'e.flg',
's.wnt', 'e.wnt'),
per=c(20190415, 20190510, 20190511, 20190710, 20190711, 20190901,
20190902, 20200414))
View(dates)
dates <- tibble(per=c('s.inc', 'e.inc', 's.nst', 'e.nst', 's.flg', 'e.flg',
's.wnt', 'e.wnt'),
doy=c(20190415, 20190510, 20190511, 20190710, 20190711, 20190901,
20190902, 20200414))
dates <- tibble(per=c('s.inc', 'e.inc', 's.nst', 'e.nst', 's.flg', 'e.flg',
's.wnt', 'e.wnt'),
doy=c(20190415, 20190510, 20190511, 20190710, 20190711, 20190901,
20190902, 20200414)) %>%
ymd(per) %>%
yday(per)
dates %>%
ymd(doy)
dates %>%
ymd(date$doy)
dates %>%
ymd(dates$doy)
ymd(dates$doy)
dates <- tibble(per=c('s.inc', 'e.inc', 's.nst', 'e.nst', 's.flg', 'e.flg',
's.wnt', 'e.wnt'),
doy=c(20190415, 20190510, 20190511, 20190710, 20190711, 20190901,
20190902, 20200414)) %>%
ymd(dates$doy)
dates <- tibble(per=c('s.inc', 'e.inc', 's.nst', 'e.nst', 's.flg', 'e.flg',
's.wnt', 'e.wnt'),
doy=c(20190415, 20190510, 20190511, 20190710, 20190711, 20190901,
20190902, 20200414)) %>%
mutate(ymd(doy))
class(dates$`ymd(doy)`)
dates <- tibble(per=c('s.inc', 'e.inc', 's.nst', 'e.nst', 's.flg', 'e.flg',
's.wnt', 'e.wnt'),
doy=c(20190415, 20190510, 20190511, 20190710, 20190711, 20190901,
20190902, 20200414)) %>%
mutate(yday(ymd(doy)))
dates <- tibble(per=c('s.inc', 'e.inc', 's.nst', 'e.nst', 's.flg', 'e.flg',
's.wnt', 'e.wnt'),
doy=c(20190415, 20190510, 20190511, 20190710, 20190711, 20190901,
20190902, 20200414)) %>%
transmute(yday(ymd(doy)))
dates <- tibble(per=c('s.inc', 'e.inc', 's.nst', 'e.nst', 's.flg', 'e.flg',
's.wnt', 'e.wnt'),
date=c(20190415, 20190510, 20190511, 20190710, 20190711, 20190901,
20190902, 20200414)) %>%
mutate(doy=yday(ymd(date)))
dates
interval(dates$doy[3, ], dates$doy[4, ])
class(dates$doy)
interval(yday(131), yday(191))
interval(ymd(20190511), ymd(20190710))
interval(ymd(20190511), ymd(20190710), tz='America/Vancouver')
ymd(c('20190511', '20190710'), tz='America/Vancouver')
nest <- ymd(c('20190511', '20190710'), tz='America/Vancouver')
interval(nest)
interval(ymd(c('20190511', '20190710'), tz='America/Vancouver'))
nest[1]
interval(nest[1], nest[2])
nest <- ymd(c('20190511', '20190710'), tz='America/Vancouver') %>%
interval(nest[1], nest[2])
interval(nest[1], nest[2])
dates <- tibble(per=c('s.inc', 'e.inc', 's.nst', 'e.nst', 's.flg', 'e.flg',
's.wnt', 'e.wnt'),
date=c(20190415, 20190510, 20190511, 20190710, 20190711, 20190901,
20190902, 20200414)) %>%
mutate(ymd(date))
dates <- tibble(per=c('s.inc', 'e.inc', 's.nst', 'e.nst', 's.flg', 'e.flg',
's.wnt', 'e.wnt'),
date=c(20190415, 20190510, 20190511, 20190710, 20190711, 20190901,
20190902, 20200414)) %>%
mutate(ymd(date, tz='America/Vancouver'))
dates <- tibble(per=c('s.inc', 'e.inc', 's.nst', 'e.nst', 's.flg', 'e.flg',
's.wnt', 'e.wnt'),
date=c(20190415, 20190510, 20190511, 20190710, 20190711, 20190901,
20190902, 20200414)) %>%
transmute(per, date=ymd(date, tz='America/Vancouver'))
dates$date[3, ]
dates$date[3]
dates$date[4]
nestling <- interval(dates$date[3], dates$date[4])
nestling <- interval(dates$date[3], dates$date[4])
fledgling <- interval(dates$date[5], dates$date[6])
winter <- interval(dates$date[7], dates$date[8])
incubation <- interval(dates$date[1], dates$date[2])
df %>%
filter(id=='HAR10')
df %>%
filter(id=='HAR10') %>%
%within% nestling
HAR10 <- df %>%
filter(id=='HAR10')
HAR10 %within% nestling
HAR10$datetime %within% nestling
HAR10$datetime %within% winter
df %>%
%within% nestling
df %>%
datetime %within% nestling
tibble(incubation, nestling, fledgling, winter)
intervals <- tibble(incubation, nestling, fledgling, winter)
View(intervals)
intervals$incubation
HAR10 %within% intervals$incubation
intervals <- as.data.frame(incubation, nestling, fledgling, winter)
View(intervals)
dput(df)
sample_n(df, 20)
df %>%
select(id, datetime) %>%
sample_n(df, 20)
df %>%
select(id, datetime) %>%
sample_n(20)
View(df)
df %>%
select(id, site, no.fix, datetime) %>%
mutate(yrls=ymd(paste(2000, month(datetime), day(datetime)))) %>%
head()
df %>%
select(id, site, no.fix, datetime) %>%
mutate(yrls=ymd(paste(2000, month(datetime), day(datetime))),
period=case_when(
yrls %within% interval(ymd(20000101), ymd(20000331)) ~ "Group 1",
yrls %within% interval(ymd(20000401), ymd(20000630)) ~ "Group 2",
yrls %within% interval(ymd(20000701), ymd(20000930)) ~ "Group 3",
yrls %within% interval(ymd(20001001), ymd(20001231)) ~ "Group 4"
)
) %>%
head()
dates
df %>%
select(id, site, no.fix, datetime) %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% interval(2019-04-15, 2019-05-10) ~ 'incubation',
yrls %within% interval(ymd(2019-05-11), ymd(2019-07-10)) ~ 'nestling',
yrls %within% interval(ymd(2019-07-11), ymd(2019-09-01)) ~ 'fledgling',
yrls %within% interval(ymd(2019-09-02), ymd(2019-12-31)) ~ 'winter',
yrls %within% interval(ymd(2019-01-01), ymd(2019-04-14)) ~ 'winter'
)
) %>%
head()
View(dates)
winter1 <- interval(dates$date[7], dates$date[8])
winter1 <- interval(dates$date[7], dates$date[8])
# Define the breeding periods.
dates <- tibble(per=c('s.inc', 'e.inc', 's.nst', 'e.nst', 's.flg', 'e.flg',
's.wnt', 'e.wnt', 's.wn2', 'e.wn2'),
date=c(20190415, 20190510, 20190511, 20190710, 20190711, 20190901,
20190902, 20191231, 20190101, 20190414)) %>%
transmute(per, date=ymd(date, tz='America/Vancouver'))
df %within% nestling
df$datetime %within% nestling
df %>%
select(id, site, no.fix, datetime) %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
head()
winter2 <- interval(dates$date[7], dates$date[8])
df %>%
select(id, site, no.fix, datetime) %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
head()
df %>%
select(id, site, no.fix, datetime) %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
group_by(site, id)
df %>%
select(id, site, no.fix, datetime) %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
group_by(site, id) %>%
summarize(n())
df %>%
select(id, site, no.fix, datetime) %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
group_by(site, id, period) %>%
summarize(n())
dates
nestling <- interval(ymd(2019-05-11), ymd(2019-07-10))
nestling <- interval(ymd(20190511), ymd(20190710))
winter2 <- interval(ymd(20190101), ymd(20190414))
incubation <- interval(ymd(20190415), ymd(20190510))
nestling <- interval(ymd(20190511), ymd(20190710))
fledgling <- interval(ymd(20190711), ymd(20190901))
winter1 <- interval(ymd(20190902), ymd(20191231))
df %>%
select(id, site, no.fix, datetime) %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
group_by(site, id, period) %>%
summarize(n())
df %>%
select(id, site, no.fix, datetime) %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
group_by(period) %>%
summarize(n())
df %>%
select(id, site, no.fix, datetime) %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
group_by(period) %>%
summarize(n()) %>%
kable(col.names=c('period', 'locations'))
df %>%
select(id, site, no.fix, datetime) %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
group_by(site, period) %>%
summarize(n()) %>%
kable(col.names=c('site', 'period', 'locations'))
df %>%
select(id, site, no.fix, datetime) %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
group_by(period) %>%
summarize(n()) %>%
kable(col.names=c('period', 'locations'))
```{r, message=FALSE, include=TRUE}
library('lubridate')
library('tidyverse')
library('knitr')
df <- read.csv('../data/processed/telem_all.csv', header=TRUE, stringsAsFactors=FALSE)
# Convert times and dates immediately, just to get it over with.
df$datetime <- ymd_hms(df$datetime, tz='America/Vancouver')
# Examine the date range for each bird.
df %>%
select(site, id, datetime) %>%
group_by(site, id) %>%
summarize(first=min(datetime), last=max(datetime),
length=difftime(last, first)) %>%
kable(col.names=c('site', 'id', 'first location', 'last location',
'time period'), digits = 2)
# Create intervals.
winter2 <- interval(ymd(20190101), ymd(20190414))
incubation <- interval(ymd(20190415), ymd(20190510))
nestling <- interval(ymd(20190511), ymd(20190710))
fledgling <- interval(ymd(20190711), ymd(20190901))
winter1 <- interval(ymd(20190902), ymd(20191231))
df %>%
select(id, site, no.fix, datetime) %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
group_by(period) %>%
summarize(n()) %>%
kable(col.names=c('period', 'locations'))
df %>%
select(id, site, no.fix, datetime) %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
filter(no.fix==0) %>%
group_by(period) %>%
summarize(n()) %>%
kable(col.names=c('period', 'locations'))
df %>%
select(id, site, no.fix, datetime) %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
filter(no.fix==0) %>%
group_by(site, period) %>%
summarize(n()) %>%
kable(col.names=c('site', 'period', 'locations'))
# Create intervals.
winter2 <- interval(ymd(20190101), ymd(20190414))
incubation <- interval(ymd(20190415), ymd(20190510))
nestling <- interval(ymd(20190511), ymd(20190710))
fledgling <- interval(ymd(20190711), ymd(20190901))
winter1 <- interval(ymd(20190902), ymd(20191231))
df %>%
select(id, site, no.fix, datetime) %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
filter(no.fix==0) %>%
group_by(period) %>%
summarize(n()) %>%
kable(col.names=c('period', 'locations'))
df %>%
select(id, site, no.fix, datetime) %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
filter(no.fix==0) %>%
group_by(site, period) %>%
summarize(n()) %>%
kable(col.names=c('site', 'period', 'locations'))
df %>%
select(id, site, no.fix, datetime) %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
filter(no.fix==0) %>%
group_by(id, period) %>%
summarize(n()) %>%
kable(col.names=c('id', 'period', 'locations'))
df %>%
select(id, site, no.fix, datetime) %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
filter(no.fix==0) %>%
group_by(id, period) %>%
summarize(n()) %>%
kable(col.names=c('id', 'period', 'locations'))
df %>%
select(id, site, no.fix, datetime) %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
filter(no.fix==0) %>%
group_by(id, period) %>%
summarize(n()) %>%
kable(col.names=c('id', 'period', 'locations'))
df %>%
select(id, site, no.fix, datetime) %>%
mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),
period=case_when(
yrls %within% incubation ~ 'incubation',
yrls %within% nestling ~ 'nestling',
yrls %within% fledgling ~ 'fledgling',
yrls %within% winter1 ~ 'winter',
yrls %within% winter2 ~ 'winter'
)
) %>%
filter(no.fix==0) %>%
group_by(site, id, period) %>%
summarize(n()) %>%
kable(col.names=c('site', 'id', 'period', 'locations'))
