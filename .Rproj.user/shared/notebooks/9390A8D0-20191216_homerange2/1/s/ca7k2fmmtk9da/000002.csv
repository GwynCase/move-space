"0","# Load in periods from previous notebook."
"0","winter2 <- interval(ymd(20190101), ymd(20190414))"
"0","incubation <- interval(ymd(20190415), ymd(20190510))"
"0","nestling <- interval(ymd(20190511), ymd(20190710))"
"0","fledgling <- interval(ymd(20190711), ymd(20190901))"
"0","winter1 <- interval(ymd(20190902), ymd(20191231))"
"0","# Do the datetime thing."
"0","df$datetime <- ymd_hms(df$datetime, tz='America/Vancouver')"
"0","# Select only the relevant data."
"0","df <- df %>%"
"0","  drop_na('lat') %>%"
"0","  mutate(yrls=ymd(paste(2019, month(datetime), day(datetime))),"
"0","         period=case_when("
"0","           yrls %within% incubation ~ 'incubation',"
"0","           yrls %within% nestling ~ 'nestling',"
"0","           yrls %within% fledgling ~ 'fledgling',"
"0","           yrls %within% winter1 ~ 'winter',"
"0","           yrls %within% winter2 ~ 'winter'"
"0","         )"
"0","  ) %>%"
"0","  filter(period == 'nestling') %>%"
"0","  filter(id %in% c('HAR10', 'HAR09', 'HAR04', 'HAR05'))"
"0","# Do the spatial thing."
"0","sf.df <- st_as_sf(df, coords=c('lon', 'lat')) %>%"
"0","  st_set_crs('+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs') %>%"
"0","  st_transform(""+proj=utm +zone=10 +datum=WGS84 +units=m +no_defs"")"
"0","# Calculate MCPs"
"0","mcp <- sf.df %>%"
"0","  dplyr::select(id, geometry) %>%"
"0","  as_Spatial() %>%"
"0","  mcp.area(percent=seq(20, 100, by=10),"
"0","           unin='m', unout='ha', plotit=FALSE) %>%"
"0","  rownames_to_column(var='name') %>%"
"0","  mutate(percent=as.numeric(name)) %>%"
"0","  dplyr::select(-name)"
"0","# Fix formatting so it can actually be graphed."
"0","mcp <- pivot_longer(mcp,"
"0","  cols=c('HAR04', 'HAR05', 'HAR09', 'HAR10'), names_to='id')"
"0","# Then graph it."
"0","ggplot(mcp, aes(percent, value, color=id)) +"
"0","  geom_point() +"
"0","  geom_path() +"
"0","  theme_classic() +"
"0","  theme(panel.grid=element_line(color='white')) +"
"0","  labs(x='Percentage location points', y='Home range area (ha)')"
